# OpenAI GPT Assistant configuration guide (backend required)

This guide explains how to configure an OpenAI GPT Assistant to assist with `gdrive_permissions1` setup and usage using the required backend service.

## Goals
- Provide consistent setup and usage guidance.
- Keep the GPT prompt stable while allowing setup steps to evolve.
- Ensure the GPT stays current by retrieving artifacts from the backend.

## Files to use
- **Prompt file (stable):** `GPT_PROMPT.md`
- **Knowledge file (regenerated):** `GPT_KNOWLEDGE.md`

> `GPT_KNOWLEDGE.md` is generated by `npm run build:docs`. It is deterministic and based on `docs/common/steps.yaml` plus the template in `GPT_KNOWLEDGE.template.md`.

## Prerequisites

- A ChatGPT account is required.

## Configure the OpenAI GPT Assistant
1. Open ChatGPT and create a new Custom GPT.
2. Set the **System Instructions** to the content of `GPT_PROMPT.md`.
3. Ensure the GPT can access the backend base URL that serves `/knowledge`, `/steps`, and `/bundle`.
4. In **Actions → Secrets**, add a secret named `BACKEND_API_KEY` with your backend key.
5. In the Action request headers, include either:
   - `X-API-Key: ${BACKEND_API_KEY}`
   - `Authorization: Bearer ${BACKEND_API_KEY}`
6. Do not upload `GPT_KNOWLEDGE.md` in the Knowledge section; it must be fetched from the backend at runtime.
7. Save the GPT.

## Usage knowledge sources
- The GPT should fetch usage guides from the backend endpoints:
  - `/usage/overview` → `docs/USER_GUIDE.md`
  - `/usage/super-admin` → `docs/SUPER_ADMIN_USER_GUIDE.md`
  - `/usage/sheet-editor` → `docs/SHEET_EDITOR_USER_GUIDE.md`
- This avoids manual GPT Knowledge uploads and keeps usage guidance in sync with the repo.

## Scope and behavior
- The GPT supports **setup** and **usage** guidance. Testing is out of scope; refer testers to `docs/TESTING.md`.
- Usage answers are **role-specific**: Super Admin vs Sheet Editor.
- The role is fixed per chat. To switch roles, start a new chat.

## Updating the knowledge
Whenever setup steps or docs change:
1. Run `npm run build:docs`.
2. Commit the regenerated `GPT_KNOWLEDGE.md` so the GPT fetches the latest version at runtime.

## Notes
- The prompt is intended to stay stable. Prefer updating the knowledge file instead of changing the prompt.
- If the GPT fails to fetch `GPT_KNOWLEDGE.md` from the backend, treat it as an error and retry after verifying the backend URL and availability.
- Production usage requires `BACKEND_API_KEY`; local development can bypass auth with `ALLOW_ANON=true`.
- The backend endpoint for the knowledge file is `/knowledge`.
